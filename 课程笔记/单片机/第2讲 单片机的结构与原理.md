# 51系列单片机外部引脚与功能

<img src="C:\Users\12548\Documents\GitHub\Notebooks\课程笔记\单片机\第2讲 单片机的结构与原理.assets\image-20200912221118755.png" alt="image-20200912221118755" style="zoom:100%;" />

<div style="text-align:center">40脚双列直插DIP封装51单片机引脚图</div>

典型51单片机有**40个**引脚（或管脚）
4组8个I/O口引脚，加8个特殊引脚，共40个

p1.0~7 RST/Vpd P3. RXD TXD INT0int1 T0t1WRRDXTAL2Xtal1vss P0~7 EA/vpp ALE/PROG PSEN

40个引脚按其功能分为**三类**：

1. I/O端口引脚，如P0，P1，P2，P3，4组8位并行I/O端口（32个）
2. 电源和时钟引脚，如Vcc，GND，XTAL1，XTAL2（4个）
3. 编程控制引脚，如RST，$\overline{PSEN}$，ALE/$\overline{PROG}$，$\overline{EA}$/Vpp（4个）

注意：/ 表示第二功能！

- Vcc（第40脚）为电源正端
- GND或Vss（第20脚）为接地端
- Vcc典型值值为+5V，最低+3.3V

XTAL1（第19脚）、XTAL2（第18脚）为外接时钟引脚

XTAL1为片内振荡电路**输入**端，XTAL2为内振荡电路**输出**端

8051时钟有两种方式：第一种是**片内**时钟振荡方式；第二种是**外部**时钟方式

单片机通常使用**12MHz**的晶振，因此一个机器周期等于1微秒

## 单片机CPU时序

<img src="C:\Users\12548\Documents\GitHub\Notebooks\课程笔记\单片机\第2讲 单片机的结构与原理.assets\image-20200912222008212.png" alt="image-20200912222008212" style="zoom:80%;" />

**振荡周期**：由振荡时钟（晶振）产生
		 振荡周期 Tosc = 1/fosc
		 **1个机器周期 = 12个振荡周期** = 12×1/fosc
**状态周期**：一个机器周期分6个状态周期Si，i=1……6，每个状态周期含两个振荡周期，即相位P1、P2
**机器周期**：机器的基本操作周期。1个指令周期含若干机器周期（单、双、四周期）

## 51复位引脚

RST/VPD（第9脚）为单片机复位引脚/备用电源输入端
当连续出现**两个机器周期以上高电平**时为有效，单片机复位，完成复位初始化操作
PC=0000H，即从存储器第0000H单元读取指令，P0—P3端口输出高电平；SP寄存器为07H；其它寄存器全部清0

**单片机复位后详细状态表**

<img src="C:\Users\12548\Documents\GitHub\Notebooks\课程笔记\单片机\第2讲 单片机的结构与原理.assets\image-20200912222316662.png" alt="image-20200912222316662" style="zoom:80%;" />

## 51存储器选择引脚

EA/Vpp（第31脚）为内部/外部ROM存储器选择端
接**高电平**时，单片机先读取内部存储器，当有外部扩展ROM时，当读完内部ROM后自动读取外部ROM
接**低电平**时，单片机直接读取外部ROM
因为单片机都有内部ROM，所以设计电路时一般此引脚始终接高电平

## 51单片机最简系统

最简系统，是使用最少的外围元器件让单片机能够工作的电路

![image-20200912222536511](C:\Users\12548\Documents\GitHub\Notebooks\课程笔记\单片机\第2讲 单片机的结构与原理.assets\image-20200912222536511.png)

AT89S51单片机的最简系统如图所示
首先，单片机的VCC、GND分别接+5V和0V以获得工作电流
然后，还多出了两部分电路（阴影框）
最后，是单片机的第31管脚外部ROM存储器选择端也接到了+5V高电平上

## 外部存储器读选引脚

$\overline{PSEN}$（第29脚）为外部ROM程序存储器的**读选通信号端**
接**低电平有效**，实现读取外部程序存储器单元，当读内部ROM时，第29脚不动作

## 地址锁存信号输出端

ALE/$\overline{PROG}$（30脚）为地址锁存信号输出端/EPROM编程脉冲输入端

有外部访问时，ALE用于控制P0口的输出低8位地址送锁存器锁存起来，实现地址和数据隔离
无外部访问时，提供1/6 fosc振荡频率，可做外部时钟或定时脉冲
当对内部RAM编写程序时，提供编程脉冲，现在较少用到

- ALE/PROG中的“ALE”是 “地址锁存使能”
- 当P0上出现的是数据时，单片机会自动使ALE/PROG =0。这样，锁存器74373的锁存使能端LE为低电平，锁存器输入端D1~D8的数据不能达到输出端Q1~Q8。于是P0的数据与存储器M28C64的数据线DQ0~DQ7进行交换
- 当P0上出现的是地址时，单片机会自动使 ALE/PROG =1。这样，74373的锁存使能端LE为高电平，锁存器输入端D1\~D8的数据顺利通过并达到输出端Q1\~Q8。这就是访问片外存储器中的低8位地址A0\~A7。再加上单片机P2同时输出的高位地址A8~A12，存储器M28C64就得到13位的地址信号，接下来就可对该地址的数据进行访问了

## 51单片机的触角——I/O端口

单片机引脚是控制外设或与外设交换信息的通道。

I/O端口引脚包括P0口、P1口、P2口、P3口**四**个端口，共**32**个引脚
四个8位的I/O端口，还兼作地址/数据线第二功能

### P0端口

- P0口：P0.0—P0.7（第39—32引脚）
- **双向8位三态I/O端口**，每个端口或引脚可独立控制
- 内部无上拉电阻，为高阻态（开路或悬空）时不能正常输出高/低电平
- 使用时一般外接10K上拉电阻
- P0口（第32—39引脚）是一个8位的开漏型双向I/O端口。P0口在作输入/输出口使用时需要添加外部上拉电阻
- 第二功能访问外部RAM/ROM，分时发送低8位地址或读写数据
- 编程/校验8751时，输入输出片内ROM数据和代码

### P1端口

- P1口：P1.0—P1.7（1—8脚）
- 准双向8位通用I/0口，每个引脚可独立控制
- 内带上拉电阻，无高阻态，也不能锁存，故不是真正的双向I/O口，成为“准双向”
- 第二功能，编程/校验8751时，接收低八位地址信号

### P2端口

- P2口：P2.0—P2.7（第21—28引脚）
- 准双向8位I/0口，每个引脚可独立控制
- 内带上拉电阻，与P1口类似
- 数据选择器MUX接Q端时为第一功能（类似P1口）， MUX接地址端时为第二功能
- P2端口的第二功能：
- 访问外部RAM/ROM，分时发送高8位地址或读写数据
- 编程/校验8751时，接收高四位地址/控制信号

### P3端口

- P3口：P3.0—P3.7（第10—17引脚）
- **准双向8位多用途I/0口**，每个引脚可独立控制
- 内带上拉电阻，作为第一功能使用时就作普通I/O口，与P1口类似
- 作为第二功能使用时，定义如下表

![image-20200917190142915](C:\Users\12548\Documents\GitHub\Notebooks\课程笔记\单片机\第2讲 单片机的结构与原理.assets\image-20200917190142915.png)

作第一功能用时，第二输出功能线为1，输出时P3.x的输出电平取决于D触发器；输入时D触发器应为1

作第二功能用时，D触发器也应为1，T2状态由第二输出功能线决定 

# 51系列单片机内部结构与单元 

## 总线

总线（BUS）是计算机各部件之间传送信息的公共通道
微机中有内部总线和外部总线两类：
内部总线是CPU内部之间的连线
外部总线是指CPU与其它部件之间的连线
外部总线又有三种: 数据总线DB（Data Bus），地址总线 AB（Address Bus）和控制总线 CB（Control Bus）

三总线与单片机引脚的对应关系

地址总线—— AB：

​	P0口提供（A7 ~ A0）；P2口提供（A15 ~ A8），共16位

数据总线—— DB：P0口提供（D7 ~ D0），共8位。

控制总线—— CB：ALE 、$\overline{EA}$ 、$\overline{PSEN}$ 、$\overline{WR}$、$\overline{RD}$  等

## I/O端口与单片机内部单元的关系

I/O端口暴露在单片机的外部，用来与外设的管脚连接

在单片机内部有相应的I/O口电路，除了4组I/O口外，单片机内部还有CPU、中断控制、片内ROM、片内RAM、定时器0/1、串行口、看门狗、总线控制、振荡器等功能模块组成

## 单片机的内部单元

1.中央处理单元CPU（8位）
     用于数据处理、位操作（位测试、置位、复位）
2.只读存储器ROM（4KB）
     用于永久性存储应用程序，掩膜ROM、EPROM、EEPROM、
     Flash Memory(闪存)
3.随机存取存取器RAM（256B）
     用于程序运行中存储工作变量和数据
4.并行输入/输出口   I / O（32线）
     用作系统总线、扩展外存、I / O接口芯片
5.串行输入/输出口   UART  （二线）
     串行通信、扩展I / O接口芯片

6.定时/计数器  T（16位增量可编程）
    它与CPU之间各自独立工作，当它计数满时向CPU中断
7.时钟电路  fosc
     分为内部振荡器、外接振荡电路
8.中断系统
      五源中断、两级优先，可编程进行控制

![image-20200917200718380](C:\Users\12548\Documents\GitHub\Notebooks\课程笔记\单片机\第2讲 单片机的结构与原理.assets\image-20200917200718380.png)

# 重点：

单片机外部40个引脚的序号，名称，分类，功能及第二功能是什么？（画引脚图）

单片机的内部结构与单元有哪些？

单片机的系统组成有哪些？